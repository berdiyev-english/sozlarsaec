<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BeWords - –ò–∑—É—á–µ–Ω–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å–ª–æ–≤</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="icon" href="/favicon.ico" sizes="any">
  
  <!-- Apple Touch Icon -->
  <link rel="apple-touch-icon" href="/icon-192.png">
  
  <!-- Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <!-- Theme Color -->
  <meta name="theme-color" content="#58CC02">
  
  <!-- Apple Meta Tags -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="BeWords">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  
  <!-- SEO –¥–ª—è –ø–æ–∏—Å–∫–æ–≤–∏–∫–æ–≤ –∏ —Å–æ—Ü—Å–µ—Ç–µ–π -->
  <meta name="description" content="–ò–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å–ª–æ–≤ —á–µ—Ä–µ–∑ –∏–≥—Ä—ã">
  <meta property="og:title" content="BeWords - –ò–∑—É—á–µ–Ω–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å–ª–æ–≤">
  <meta property="og:description" content="–ò–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å–ª–æ–≤ —á–µ—Ä–µ–∑ –∏–≥—Ä—ã">
  <meta property="og:image" content="https://bewords.ru/og-image.png">
  <meta property="og:url" content="https://bewords.ru">
  <meta property="og:type" content="website">
  <link rel="canonical" href="https://bewords.ru">
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
  .app-install-banner {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, #58CC02 0%, #89E219 100%);
    box-shadow: 0 2px 10px rgba(0,0,0,0.15);
    z-index: 10000;
    padding: 10px 15px;
    animation: slideDown 0.3s ease-out;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    display: none;
  }

  .app-install-banner.show {
    display: block;
  }

  @keyframes slideDown {
    from { transform: translateY(-100%); }
    to { transform: translateY(0); }
  }

  .banner-content {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
  }

  .banner-close {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255,255,255,0.2);
    border: none;
    color: white;
    font-size: 24px;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.9;
    transition: opacity 0.2s;
  }

  .banner-close:hover {
    opacity: 1;
  }

  .banner-info {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
  }

  .banner-icon {
    width: 45px;
    height: 45px;
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
  }

  .banner-text {
    color: white;
  }

  .banner-text h4 {
    margin: 0;
    font-size: 15px;
    font-weight: 700;
    margin-bottom: 2px;
  }

  .banner-text p {
    margin: 0;
    font-size: 12px;
    opacity: 0.95;
  }

  .banner-install-btn {
    background: white;
    color: #58CC02;
    padding: 7px 18px;
    border-radius: 10px;
    text-decoration: none;
    font-weight: 700;
    font-size: 14px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    transition: transform 0.2s, box-shadow 0.2s;
    white-space: nowrap;
    margin-right: 35px;
  }

  .banner-install-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }

  /* –°–¥–≤–∏–≥–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –≤–Ω–∏–∑ –∫–æ–≥–¥–∞ –±–∞–Ω–Ω–µ—Ä –ø–æ–∫–∞–∑–∞–Ω */
  body.banner-shown {
    padding-top: 50px;
  }

  body.banner-shown .app-header {
    top: 50px;
  }

  /* –ê–¥–∞–ø—Ç–∏–≤ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
  @media (max-width: 480px) {
    .app-install-banner {
      padding: 8px 10px;
    }
    
    .banner-icon {
      width: 38px;
      height: 38px;
    }
    
    .banner-text h4 {
      font-size: 13px;
    }
    
    .banner-text p {
      font-size: 11px;
    }
    
    .banner-install-btn {
      padding: 6px 14px;
      font-size: 12px;
    }

    body.banner-shown {
      padding-top: 20px;
    }

    body.banner-shown .app-header {
      top: 20px;
    }
  }
  
  /* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–π –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
@media (max-width: 768px) {
    /* –í–∫–ª—é—á–∞–µ–º –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ */
    .words-container {
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
    }
    
    /* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–∞ */
    .main-content {
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
    }
}

/* –ü–ª–∞–≤–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–π –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö */
* {
    -webkit-tap-highlight-color: transparent;
}

html {
    scroll-behavior: smooth;
}

/* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥–µ—Ä–≥–∞–Ω–∏–π –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ */
body {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

  /* –°–∫—Ä—ã–≤–∞–µ–º –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ */
  @media (min-width: 1024px) {
    .app-install-banner {
      display: none !important;
    }
  }
    /* AI Chat Iframe Styles */
    .ai-chat-container {
      width: 100%;
      height: calc(100vh - 200px);
      min-height: 500px;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .ai-chat-iframe {
      width: 100%;
      height: 100%;
      border: none;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      background: var(--bg-secondary);
    }
    .ai-chat-description {
      background: var(--bg-secondary);
      padding: 1rem;
      border-radius: 12px;
      border-left: 4px solid var(--accent-primary);
      margin-bottom: 1rem;
    }
    .ai-chat-description h3 {
      margin: 0 0 0.5rem 0;
      color: var(--text-primary);
      font-size: 1.1rem;
    }
    .ai-chat-description p {
      margin: 0;
      color: var(--text-secondary);
      font-size: 0.95rem;
      line-height: 1.5;
    }

    /* Header */
    .info-btn, .theme-toggle { display: none !important; }
    .settings-btn {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      width: 40px; height: 40px;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; transition: all 0.2s ease; color: var(--text-primary);
    }
    .settings-btn:hover { background: var(--accent-primary); color: #fff; transform: translateY(-2px); }

    /* Keep bulk header visible */
    .words-header {
      position: sticky;
      top: 64px; /* —Å–º–µ—â–µ–Ω–∏–µ –ø–æ–¥ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —à–∞–ø–∫—É, –ø–æ–¥—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥ –≤–∞—à header */
      z-index: 5;
      background: var(--bg-primary);
    }

    /* Buttons text in word cards */
    .action-text-btn {
      border: 1px solid var(--border-color);
      background: var(--bg-secondary);
      padding: 6px 10px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      color: var(--text-primary);
    }
    .action-text-btn.add { border-color: #10b981; color: #10b981; background: #ecfdf5; }
    .action-text-btn.remove { border-color: #ef4444; color: #ef4444; background: #fee2e2; }
    .action-text-btn:hover { filter: brightness(0.98); }

    /* Mobile adaptations */
    @media (max-width: 768px) {
      .ai-chat-container { height: calc(100vh - 180px); min-height: 400px; }
      .ai-chat-description { padding: 0.75rem; }
      .ai-chat-description h3 { font-size: 1rem; }
      .ai-chat-description p { font-size: 0.9rem; }
    }
    @media (max-width: 480px) {
      .ai-chat-container { height: calc(100vh - 160px); min-height: 350px; }
    }
  </style>
  <!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105128338', 'ym');

    ym(105128338, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105128338" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
</head>
<body>
  <!-- App Install Banner -->
<div id="appInstallBanner" class="app-install-banner">
  <div class="banner-content">
    <div class="banner-info">
      <img src="/logo1.png" alt="BeWords" class="banner-icon">
      <div class="banner-text">
        <h4>BeWords - –£—á–∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π</h4>
        <p>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ª—É—á—à–µ–≥–æ –æ–ø—ã—Ç–∞!</p>
      </div>
    </div>
    <a href="#" class="banner-install-btn" id="bannerInstallBtn">
      –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
    </a>
    <button class="banner-close" onclick="closeInstallBanner()" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
  </div>
</div>
  
<div class="app-container">
  <header class="app-header">
    <div class="header-content">
      <div class="logo-title">
        <a href="/" class="logo-link" onclick="location.reload(); return false;">
          <img src="/logo1.png" alt="BeWords" class="app-logo">
        </a>
        <h1 class="app-title">BeWords</h1>
      </div>
      <div class="header-actions">
        <button class="support-btn" id="supportBtn" data-testid="support-btn" title="–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç">
          <i class="fas fa-heart"></i>
        </button>
        <button class="settings-btn" id="settingsBtn" data-testid="settings-btn" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </div>
  </header>

  <main class="main-content">
    <!-- Levels + Categories -->
    <section id="levels" class="content-section active">
      <div class="section-header">
        <h2>–°–ª–æ–≤–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º</h2>
      </div>

      <div class="levels-grid" id="levelsGrid">
        <div class="level-card" data-level="A1" data-testid="level-card-A1" onclick="window.app && app.showLevelWords('A1')">
          <div class="level-badge beginner">A1</div>
          <h3>Beginner</h3>
          <p>–ë–∞–∑–æ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
        <div class="level-card" data-level="A2" data-testid="level-card-A2" onclick="window.app && app.showLevelWords('A2')">
          <div class="level-badge elementary">A2</div>
          <h3>Elementary</h3>
          <p>–≠–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
        <div class="level-card" data-level="B1" data-testid="level-card-B1" onclick="window.app && app.showLevelWords('B1')">
          <div class="level-badge intermediate">B1</div>
          <h3>Intermediate</h3>
          <p>–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
        <div class="level-card" data-level="B2" data-testid="level-card-B2" onclick="window.app && app.showLevelWords('B2')">
          <div class="level-badge upper-intermediate">B2</div>
          <h3>Upper-Intermediate</h3>
          <p>–í—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
        <div class="level-card" data-level="C1" data-testid="level-card-C1" onclick="window.app && app.showLevelWords('C1')">
          <div class="level-badge advanced">C1</div>
          <h3>Advanced</h3>
          <p>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
        <div class="level-card" data-level="C2" data-testid="level-card-C2" onclick="window.app && app.showLevelWords('C2')">
          <div class="level-badge proficiency">C2</div>
          <h3>Proficiency</h3>
          <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
      </div>

      <!-- Categories -->
      <div class="section-header" style="margin-top:1rem;">
        <h2>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
      </div>
      <div class="levels-grid" id="categoriesGrid">
        <div class="level-card" data-category="IRREGULARS" data-testid="category-card-irregulars" onclick="window.app && app.showCategoryWords('IRREGULARS')">
          <div class="level-badge advanced">Irregular Verbs</div>
          <h3>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã</h3>
          <p>–§–æ—Ä–º—ã –≥–ª–∞–≥–æ–ª–æ–≤</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
        <div class="level-card" data-category="PREPOSITIONS" data-testid="category-card-prepositions">
          <div class="level-badge elementary">Prepositions</div>
          <h3>–ü—Ä–µ–¥–ª–æ–≥–∏</h3>
          <p>–ß–∞—Å—Ç—ã–µ –ø—Ä–µ–¥–ª–æ–≥–∏</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
        <div class="level-card" data-category="PHRASAL_VERBS" data-testid="category-card-phrasal">
          <div class="level-badge beginner">Phrasal Verbs</div>
          <h3>–§—Ä–∞–∑–æ–≤—ã–µ –≥–ª–∞–≥–æ–ª—ã</h3>
          <p>–ß–∞—Å—Ç—ã–µ —Ñ—Ä–∞–∑–æ–≤—ã–µ –≥–ª–∞–≥–æ–ª—ã</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
        <div class="level-card" data-category="IDIOMS" data-testid="category-card-idioms">
          <div class="level-badge proficiency">Idioms</div>
          <h3>–ò–¥–∏–æ–º—ã</h3>
          <p>–†–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
         <div class="level-card" data-category="MEDICAL" data-testid="category-card-medical">
          <div class="level-badge elementary">Medical</div>
          <h3>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –∞–Ω–≥–ª–∏–π—Å–∫–∏–π</h3>
          <p>–ë–∞–∑–∞ –¥–ª—è –≤—Å–µ—Ö</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
      </div>
      
            <!-- Exams -->
      <div class="section-header" style="margin-top:1rem;">
        <h2>–≠–∫–∑–∞–º–µ–Ω—ã</h2>
      </div>
      <div class="levels-grid" id="examsGrid">
        <div class="level-card" data-category="EGE" data-testid="category-card-ege">
          <div class="level-badge elementary">–ï–ì–≠</div>
          <h3>–ï–ì–≠</h3>
          <p>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ï–ì–≠</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
        <div class="level-card" data-category="OGE" data-testid="category-card-oge">
          <div class="level-badge beginner">–û–ì–≠</div>
          <h3>–û–ì–≠</h3>
          <p>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –û–ì–≠</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
        <div class="level-card" data-category="IELTS" data-testid="category-card-ielts">
          <div class="level-badge upper-intermediate">IELTS</div>
          <h3>IELTS</h3>
          <p>Academic / General</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
        <div class="level-card" data-category="TOEFL" data-testid="category-card-toefl">
          <div class="level-badge advanced">TOEFL</div>
          <h3>TOEFL</h3>
          <p>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ TOEFL</p>
          <div class="level-stats"><span class="word-count">0 —Å–ª–æ–≤</span></div>
        </div>
      </div>

      <!-- Words List (levels or categories) -->
      <div id="wordsContainer" class="words-container hidden">
        <div class="words-header">
          <button class="back-btn" id="backToLevels" data-testid="back-to-levels" onclick="window.app && app.backToLevels()">
            <i class="fas fa-arrow-left"></i>
            –ù–∞–∑–∞–¥
          </button>
          <h3 id="currentLevelTitle">–°–ª–æ–≤–∞</h3>
          <div class="level-bulk-actions">
            <button id="bulkToggleBtn" class="action-text-btn add" data-testid="bulk-toggle-btn" title="–î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ">
              –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ
            </button>
          </div>
        </div>
        <div id="wordsList" class="words-list"></div>
      </div>
    </section>

<!-- Learning -->
<section id="learning" class="content-section">
  <div class="section-header">
    <h2>–ò–∑—É—á–∞—é</h2>
    <div class="section-stats"><span id="learningCount">0 —Å–ª–æ–≤</span></div>
  </div>

  <p class="mode-help">
    –†–µ–∂–∏–º—ã –ø—Ä–∞–∫—Ç–∏–∫–∏:<br><br>
    1) –ó–∞—É—á–∏–≤–∞–Ω–∏–µ - –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –Ω–µ–∑–Ω–∞–∫–æ–º—ã—Ö —Å–ª–æ–≤. –°–∏—Å—Ç–µ–º–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–ª–æ–≤–∞ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤. –î–æ–±–∞–≤–∏–ª–∏ 500 —Å–ª–æ–≤? –ù–µ –≤–æ–ª–Ω—É–π—Ç–µ—Å—å ‚Äî —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç–µ 20, –ø–æ—Ç–æ–º –µ—â–µ 10, –µ—â–µ 10 –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –£—á–∏—Ç—å —Å—Ä–∞–∑—É –≤—Å–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, –ø–æ—ç—Ç–æ–º—É —Å–∏—Å—Ç–µ–º–∞ –¥–æ–∑–∏—Ä—É–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É.<br>
   <br> 2) –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ - –Ω—É–∂–µ–Ω –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤—Å–ø–æ–º–Ω–∏—Ç—å –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Å–ª–æ–≤–∞<br>
  </p>

<div class="toggles-row">
  <div class="mode-toggle" role="tablist" aria-label="study mode">
    <button class="mode-btn active" data-mode="quiz" id="modeQuiz" data-testid="mode-quiz">Quiz</button>
    <button class="mode-btn" data-mode="flashcards" id="modeFlashcards" data-testid="mode-flashcards">–§–ª–µ—à–∫–∞—Ä—Ç–æ—á–∫–∏</button>
    <button class="mode-btn" data-mode="trainer" id="modeTrainer" data-testid="mode-trainer">–¢—Ä–µ–Ω–∞–∂–µ—Ä</button>
  </div>
  <div class="practice-toggle" role="tablist" aria-label="practice mode">
    <button class="practice-btn active" data-practice="scheduled" id="practiceScheduled" data-testid="practice-scheduled">–ó–∞—É—á–∏–≤–∞–Ω–∏–µ</button>
    <button class="practice-btn" data-practice="endless" id="practiceEndless" data-testid="practice-endless">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ</button>
    <button class="practice-btn" data-practice="list" id="practiceList" data-testid="practice-list">
      <i class="fas fa-list"></i> –°–ø–∏—Å–æ–∫
    </button>
  </div>
</div>

<div id="learningWordsList" class="learning-words-list"></div>
</section>
    <!-- New Words -->
  <section id="new-words" class="content-section"> <div id="translatorWidget" class="translator-card"> <div class="translator-header"> <h3>BeWords - Translate</h3> <p>–ò—â–∏—Ç–µ —Å–ª–æ–≤–∞ –∏ —Ñ—Ä–∞–∑—ã –∏ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –∏—Ö –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ</p> </div>
<div class="tr-lang-row">
  <button class="tr-lang-btn active" id="trRuBtn" type="button">üá∑üá∫ –†—É—Å—Å–∫–∏–π</button>
  <button class="tr-swap-btn" id="trSwapBtn" type="button" title="–ü–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏">‚áÑ</button>
  <button class="tr-lang-btn" id="trEnBtn" type="button">üá¨üáß English</button>
</div>

<div class="tr-input-row">
  <input type="text" id="trInputText" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –∏–ª–∏ —Ñ—Ä–∞–∑—É..." />
  <button id="trTranslateBtn" type="button">–ü–µ—Ä–µ–≤–µ—Å—Ç–∏</button>
</div>

<div class="translator-loading" id="trLoading">
  <div class="tr-spinner"></div>
  <p>–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–µ—Ä–µ–≤–æ–¥–∞...</p>
</div>

<div class="translator-error" id="trError"></div>
<div class="translator-results" id="trResults"></div>
</div> <div class="section-header"> <h2>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞</h2> </div> <div class="toggles-row"> <div class="upload-toggle" role="tablist" aria-label="upload mode"> <button class="upload-btn active" id="uploadTabSingle" data-tab="single">–û–¥–Ω–æ —Å–ª–æ–≤–æ</button> <button class="upload-btn" id="uploadTabBulk" data-tab="bulk">–ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ</button> </div> </div> <p id="singleHelp" class="mode-help"> –í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º –∏ –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–∏–π. –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤–æ —Å—Ä–∞–∑—É –ø–æ–ø–∞–¥—ë—Ç –≤ –≤–∞—à —Å–ª–æ–≤–∞—Ä—å. </p> <div class="add-word-form" id="singleAddForm"> <div class="form-group"> <label for="newWord">–ê–Ω–≥–ª–∏–π—Å–∫–æ–µ —Å–ª–æ–≤–æ</label> <input type="text" id="newWord" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º" data-testid="new-word-input"> </div> <div class="form-group"> <label for="newTranslation">–ü–µ—Ä–µ–≤–æ–¥</label> <input type="text" id="newTranslation" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥" data-testid="new-translation-input"> </div> <div class="form-group"> <label for="newLevel">–£—Ä–æ–≤–µ–Ω—å</label> <select id="newLevel" data-testid="new-level-select"> <option value="A1">A1 - Beginner</option> <option value="A2">A2 - Elementary</option> <option value="B1">B1 - Intermediate</option> <option value="B2">B2 - Upper-Intermediate</option> <option value="C1">C1 - Advanced</option> <option value="C2">C2 - Proficiency</option> <option value="IRREGULARS">Irregular Verbs</option> <option value="PREPOSITIONS">Prepositions</option> </select> </div> <button class="add-word-btn" id="addWordBtn" data-testid="add-word-btn"> <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ </button> </div> <div class="add-word-form" id="bulkAddForm" style="display:none;"> <h3 style="margin-bottom:8px;">–ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ</h3> <p class="mode-help" id="bulkHelp" data-testid="bulk-help"> –ö–∞–∂–¥–æ–µ –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ —Å–ª–æ–≤–æ / —Ñ—Ä–∞–∑—É –≤–≤–æ–¥–∏—Ç–µ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏.<br><br> –ü–µ—Ä–µ–≤–æ–¥ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ "-" (–Ω–∞–ø—Ä–∏–º–µ—Ä: go - –∏–¥—Ç–∏, –µ—Ö–∞—Ç—å, —Ö–æ–¥–∏—Ç—å) </p> <div class="form-group"> <label for="bulkLevel">–£—Ä–æ–≤–µ–Ω—å –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ–≤</label> <select id="bulkLevel" data-testid="bulk-level-select"> <option value="A1">A1 - Beginner</option> <option value="A2">A2 - Elementary</option> <option value="B1">B1 - Intermediate</option> <option value="B2">B2 - Upper-Intermediate</option> <option value="C1">C1 - Advanced</option> <option value="C2">C2 - Proficiency</option> <option value="IRREGULARS">Irregular Verbs</option> <option value="PREPOSITIONS">Prepositions</option> </select> </div> <div class="form-group"> <label for="bulkTextarea">–í—Å—Ç–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫–∏</label> <textarea id="bulkTextarea" rows="6" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä : &#10;&#10;go - –∏–¥—Ç–∏, –µ—Ö–∞—Ç—å, —Ö–æ–¥–∏—Ç—å&#10;table - —Å—Ç–æ–ª&#10;run - –±–µ–∂–∞—Ç—å, –∑–∞–ø—É—Å–∫–∞—Ç—å" data-testid="bulk-textarea" style="width:100%;padding:0.75rem;border:1px solid var(--border-color);border-radius:var(--radius-md);background:var(--bg-primary);color:var(--text-primary);"></textarea> </div> <button class="add-word-btn" id="bulkAddBtn" data-testid="bulk-add-btn"> <i class="fas fa-file-import"></i> –î–æ–±–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ </button> </div> <div id="customWordsList" class="words-list"> <h3>–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞</h3> <div id="customWords"> <div class="empty-state"> <i class="fas fa-plus-circle"></i> <h3>–ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤</h3> <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º—ã –≤—ã—à–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–ª–æ–≤</p> </div> </div> </div> </section>
  
    <!-- Progress -->
    <section id="progress" class="content-section">
      <div class="section-header">
        <h2>–ü—Ä–æ–≥—Ä–µ—Å—Å</h2>
      </div>
      <div id="progressContent" class="progress-content"></div>
    </section>

    <!-- Games -->
    <section id="games" class="content-section">
      <div class="section-header">
        <h2>–ò–≥—Ä—ã</h2>
      </div>

      <p class="mode-help">
        –ò–≥—Ä–∞–π—Ç–µ –≤ –∏–≥—Ä—ã –∏ –∏–∑—É—á–∞–π—Ç–µ —Å–ª–æ–≤–∞ –≤ –ê–Ω–≥–ª–∏–π—Å–∫–æ–º.<br><br>
        –ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É –Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à–∏—Ç—å quiz.<br><br>
        –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –∏–≥—Ä—ã –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ quiz –∏–∑ 4 —Å–ª–æ–≤ , —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä–∞—Ç—å<br><br>
        –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∑–∞ —á–∞—Å –≤—ã –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ 48 —Å–ª–æ–≤ –ø—Ä–æ—Å—Ç–æ –∏–≥—Ä–∞—è –≤ –∏–≥—Ä—ã<br><br>
        –ù–æ–≤–∞—è —ç—Ä–∞ –æ–±—É—á–µ–Ω–∏—è –Ω–∞—á–∞–ª–∞—Å—å —Å "Bewords"<br>
      </p>

      <div class="games-grid">
        <div class="game-card">
          <img src="race.jpg" alt="Subway Surfers" class="game-cover" onerror="this.src='nophoto.jpg'">
          <div class="game-info">
            <h3>Subway Surfers</h3>
            <p>–£–±–µ–≥–∞–π –æ—Ç –∑–ª–æ–≥–æ –æ—Ö—Ä–∞–Ω–Ω–∏–∫–∞. </p>
            <button class="btn btn-primary" id="surfStartBtn" data-testid="surf-start-btn">–°—Ç–∞—Ä—Ç</button>
          </div>
        </div>

        <div class="game-card">
          <img src="bird.jpg" alt="Doodle Jump" class="game-cover" onerror="this.src='nophoto.jpg'">
          <div class="game-info">
            <h3>Flying Bird</h3>
            <p>–ü–æ–ª–µ—Ç–∞–π –∑–∞ –∑–Ω–∞–º–µ–Ω–∏—Ç—É—é –ø—Ç–∏—Ü—É.</p>
            <button class="btn btn-primary" id="doodleStartBtn" data-testid="doodle-start-btn">–°—Ç–∞—Ä—Ç</button>
          </div>
        </div>

        <div class="game-card">
          <img src="2048.jpg" alt="2048" class="game-cover" onerror="this.src='nophoto.jpg'">
          <div class="game-info">
            <h3>2048</h3>
            <p>–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∞. –°–æ–±–µ—Ä–∏ –ø–ª–∏—Ç–∫—É 2048!</p>
            <button class="btn btn-primary" id="game2048StartBtn" data-testid="2048-start-btn">–°—Ç–∞—Ä—Ç</button>
          </div>
        </div>

        <div class="game-card">
          <img src="match3.jpg" alt="Rocket Soccer Derby" class="game-cover" onerror="this.src='nophoto.jpg'">
          <div class="game-info">
            <h3>Daddy Panda</h3>
            <p>–ü–æ–º–æ–≥–∏ –ø–∞–ø–µ –ø–∞–Ω–¥–µ —Å–ø–∞—Å—Ç–∏ —Å–≤–æ–∏—Ö –¥–µ—Ç–µ–π</p>
            <button class="btn btn-primary" id="rocketStartBtn" data-testid="rocket-start-btn">–°—Ç–∞—Ä—Ç</button>
          </div>
        </div>

          <div class="game-card">
          <img src="ninja.jpg" alt="ninja" class="game-cover" onerror="this.src='nophoto.jpg'">
          <div class="game-info">
            <h3>Fruit Ninja</h3>
            <p>–†–µ–∂—å —Ñ—Ä—É–∫—Ç—ã –∏ –∏–∑–±–µ–≥–∞–π –±–æ–º–± ‚Äî —ç—Ç–æ –≤—Å–µ, —á—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∏–≥—Ä–∞—Ç—å –≤ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â—É—é –∏–≥—Ä—É Fruit Ninja!</p>
            <button class="btn btn-primary" id="ninjaStartBtn" data-testid="ninja-start-btn">–°—Ç–∞—Ä—Ç</button>
          </div>
        </div>

        <div class="game-card">
          <img src="dash.jpg" alt="–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä" class="game-cover" onerror="this.src='nophoto.jpg'">
          <div class="game-info">
            <h3>Geometry-dash</h3>
            <p>–ó–Ω–∞–º–µ–Ω–∏—Ç–∞—è –∏–≥—Ä–∞ —Å –ø—Ä—ã–≥–∞—é—â–µ–º –∫—É–±–∏–∫–æ–º.</p>
            <button class="btn btn-primary" id="catalogStartBtn" data-testid="catalog-start-btn">–°—Ç–∞—Ä—Ç</button>
          </div>
        </div>
      </div>
    </section>

    <!-- AI Chat -->
<section id="ai-chat" class="content-section">
  <div class="ai-chat-description">
    <h3>–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π AI-–ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –Ω–∞ –±–∞–∑–µ Chat GPT</h3>
    <p>–ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã, –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π –∞–Ω–≥–ª–∏–π—Å–∫–∏–π, –ø–æ–ª—É—á–∞–π—Ç–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏ –∏ –ø–æ–º–æ—â—å —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º. AI-—É—á–∏—Ç–µ–ª—å –¥–æ—Å—Ç—É–ø–µ–Ω 24/7 –∏ –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤ –ø–æ–º–æ—á—å!</p> <br>
    <h3>–ï—Å–ª–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —á–∞—Ç –≤–∫–ª—é—á–∏—Ç–µ VPN üåê</h3>
  </div>

  <div class="ai-chat-container">
    <iframe
      id="aiChatFrame"
      src="https://www.yeschat.ai/i/gpts-2OToO9hERt-English-Teacher"
      class="ai-chat-iframe"
      title="AI English Teacher"
      allow="microphone">
    </iframe>
  </div>
  
  <!-- VPN —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –ø–æ–¥ iframe -->
  <div id="vpnMessage" class="vpn-message">
    <div class="vpn-icon">üåç</div>
    <div class="vpn-content">
      <h4>–£–ø—Å! AI Chat –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</h4>
      <p>–ß—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å AI Chat, –≤–∫–ª—é—á–∏—Ç–µ VPN</p>
      <button class="vpn-retry-btn" onclick="retryLoadingChat()">
        <i class="fas fa-redo"></i> –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
      </button>
    </div>
  </div>
</section>
  </main>

<nav class="bottom-nav" id="bottomNav">
  <button class="nav-item active" type="button" data-section="levels" data-testid="nav-levels">
    <i class="fas fa-layer-group"></i><span>–°–ø–∏—Å–∫–∏</span>
  </button>
  <button class="nav-item" type="button" data-section="learning" data-testid="nav-learning">
    <i class="fas fa-book-reader"></i><span>–ò–∑—É—á–∞—é</span>
  </button>
  <button class="nav-item" type="button" data-section="new-words" data-testid="nav-new-words">
    <i class="fas fa-plus"></i><span>–ó–∞–≥—Ä—É–∑–∏—Ç—å</span>
  </button>
  <button class="nav-item" type="button" data-section="progress" data-testid="nav-progress">
    <i class="fas fa-chart-line"></i><span>–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
  </button>
  <button class="nav-item" type="button" data-section="games" data-testid="nav-games">
    <i class="fas fa-gamepad"></i><span>–ò–≥—Ä—ã</span>
  </button>
  <button class="nav-item" type="button" data-section="ai-chat" data-testid="nav-ai-chat">
    <i class="fas fa-robot"></i><span>–ò–ò</span>
  </button>
</nav>
</div>

<audio id="audioPlayer" preload="none"></audio>

<script src="oxford_words_data.js"></script>
<script src="sentences-data.js"></script>
<script src="app.js"></script>
<script>
  // Service Worker registration (image caching)
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/service-worker.js').catch(() => {});
    });
  }
</script>
<script>
let iframeCheckInterval;
let checkAttempts = 0;

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ iframe –¥–ª—è AI Chat
function checkIframeLoad() {
  const iframe = document.getElementById('aiChatFrame');
  const vpnMessage = document.getElementById('vpnMessage');
  
  if (!iframe || !vpnMessage) return;
  
  // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
  if (iframeCheckInterval) {
    clearInterval(iframeCheckInterval);
  }
  checkAttempts = 0;
  
  // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ
  vpnMessage.classList.remove('show');
  iframe.classList.remove('has-error');
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∫–∞–∂–¥—ã–µ 500–º—Å
  iframeCheckInterval = setInterval(() => {
    checkAttempts++;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
    const rect = iframe.getBoundingClientRect();
    const isVisible = rect.width > 0 && rect.height > 0;
    const hasContent = iframe.contentWindow !== null;
    
    // –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ 5 –ø–æ–ø—ã—Ç–æ–∫ (2.5 —Å–µ–∫—É–Ω–¥—ã) –∏ iframe –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
    if (checkAttempts >= 5) {
      clearInterval(iframeCheckInterval);
      
      // –ü—ã—Ç–∞–µ–º—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å iframe
      try {
        // –ï—Å–ª–∏ –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ window, –∑–Ω–∞—á–∏—Ç –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
        if (iframe.contentWindow && iframe.contentWindow.location) {
          console.log('Iframe loaded successfully');
          vpnMessage.classList.remove('show');
          iframe.classList.remove('has-error');
        }
      } catch (e) {
        // Cross-origin –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ - —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö iframe
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º
        if (!isVisible) {
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
          console.log('Iframe failed to load - showing VPN message');
          vpnMessage.classList.add('show');
          iframe.classList.add('has-error');
        }
      }
    }
  }, 500);
  
  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏–µ error
  iframe.onerror = function() {
    clearInterval(iframeCheckInterval);
    vpnMessage.classList.add('show');
    iframe.classList.add('has-error');
  };
}

// –§—É–Ω–∫—Ü–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
function retryLoadingChat() {
  const iframe = document.getElementById('aiChatFrame');
  const vpnMessage = document.getElementById('vpnMessage');
  
  if (iframe && vpnMessage) {
    // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    vpnMessage.classList.remove('show');
    iframe.classList.remove('has-error');
    
    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º iframe
    const currentSrc = iframe.src;
    iframe.src = 'about:blank';
    
    setTimeout(() => {
      iframe.src = currentSrc;
      // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–Ω–æ–≤–æ
      setTimeout(checkIframeLoad, 100);
    }, 100);
  }
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É AI Chat
document.addEventListener('DOMContentLoaded', function() {
  // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  setTimeout(() => {
    const originalSwitchSection = window.app && window.app.switchSection;
    
    if (originalSwitchSection) {
      window.app.switchSection = function(section) {
        originalSwitchSection.call(window.app, section);
        
        if (section === 'ai-chat') {
          // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É
          setTimeout(checkIframeLoad, 100);
        }
      };
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ä–∞–∑—É –Ω–∞ —ç—Ç–æ–π –≤–∫–ª–∞–¥–∫–µ
    const aiChatSection = document.querySelector('#ai-chat');
    if (aiChatSection && aiChatSection.classList.contains('active')) {
      checkIframeLoad();
    }
  }, 1000);
});

// –¢–∞–∫–∂–µ –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
window.addEventListener('load', function() {
  const aiChatSection = document.querySelector('#ai-chat');
  if (aiChatSection && aiChatSection.classList.contains('active')) {
    checkIframeLoad();
  }
});
</script>
<script>
// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–æ–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
(function() {
  const banner = document.getElementById('appInstallBanner');
  const installBtn = document.getElementById('bannerInstallBtn');
  
  if (!banner || !installBtn) return;
  
  const userAgent = navigator.userAgent.toLowerCase();
  const isIOS = /iphone|ipad|ipod/.test(userAgent);
  const isAndroid = /android/.test(userAgent);
  const isMobile = /mobile/.test(userAgent);
  const isTablet = /tablet|ipad|playbook|silk/.test(userAgent);
  
  const isStandalone = window.navigator.standalone || 
                       window.matchMedia('(display-mode: standalone)').matches ||
                       window.matchMedia('(display-mode: fullscreen)').matches;
  
  const isFromApp = document.referrer.includes('android-app://');
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –±–∞–Ω–Ω–µ—Ä
  const shouldShowBanner = (isMobile || isTablet) && !isStandalone && !isFromApp;
  
  if (!shouldShowBanner) return;
  
  // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –û–°
  if (isIOS) {
    installBtn.textContent = '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å';
    installBtn.href = '/iphone.html';
    installBtn.onclick = function(e) {
      if (typeof ym !== 'undefined') {
        ym(105128338, 'reachGoal', 'install_instructions_ios');
      }
    };
  } else if (isAndroid) {
    installBtn.textContent = '–°–∫–∞—á–∞—Ç—å';
    installBtn.href = '/android.html';
    installBtn.onclick = function(e) {
      if (typeof ym !== 'undefined') {
        ym(105128338, 'reachGoal', 'download_app_android');
      }
    };
  } else {
    installBtn.textContent = '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å';
    installBtn.href = '#';
  }
  
  // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –±–∞–Ω–Ω–µ—Ä–∞
  function showBanner() {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
    const tourOverlay = document.getElementById('firstRunTour');
    const motivationOverlay = document.getElementById('motivationOverlay');
    
    if (tourOverlay || motivationOverlay) {
      // –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –∏–ª–∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è - –ø–æ–≤—Ç–æ—Ä—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
      setTimeout(showBanner, 3000);
      return;
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–Ω–Ω–µ—Ä
    banner.classList.add('show');
    document.body.classList.add('banner-shown');
    console.log('Banner shown');
  }
  
  // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–∫–∞–∑ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
  setTimeout(() => {
    const firstRunDone = localStorage.getItem('first_run_completed') === '1';
    console.log('Banner timer - firstRunDone:', firstRunDone);
    
    if (firstRunDone) {
      // –ï—Å–ª–∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –±—ã–ª–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ä–∞–∑—É (–∏–ª–∏ –∂–¥–µ–º –º–æ—Ç–∏–≤–∞—Ü–∏—é)
      showBanner();
    } else {
      // –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ - –∂–¥–µ–º –¥–æ–ª—å—à–µ
      setTimeout(showBanner, 5000);
    }
  }, 5000);
  
  // PWA —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è Android
  let deferredPrompt;
  
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    
    if (banner && banner.classList.contains('show') && !isIOS) {
      installBtn.textContent = '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PWA';
      installBtn.href = '#';
      installBtn.onclick = async function(e) {
        e.preventDefault();
        if (deferredPrompt) {
          deferredPrompt.prompt();
          const { outcome } = await deferredPrompt.userChoice;
          
          if (outcome === 'accepted') {
            closeInstallBanner();
            if (typeof ym !== 'undefined') {
              ym(105128338, 'reachGoal', 'pwa_installed');
            }
          }
          deferredPrompt = null;
        }
      };
    }
  });
})();

function closeInstallBanner() {
  const banner = document.getElementById('appInstallBanner');
  
  if (banner) {
    banner.style.animation = 'slideUp 0.3s ease-out';
    
    setTimeout(() => {
      banner.classList.remove('show');
      document.body.classList.remove('banner-shown');
    }, 300);
    
    if (typeof ym !== 'undefined') {
      ym(105128338, 'reachGoal', 'banner_closed');
    }
  }
}
</script>
<script>
(function(){
  let src = 'ru', tgt = 'en', bound = !1;

  function $id(id){ return document.getElementById(id); }

function setLang(from, to){
  src = from;
  tgt = to;

  const ruBtn = $id('trRuBtn');
  const enBtn = $id('trEnBtn');
  if (!ruBtn || !enBtn) return;

  // from = —è–∑—ã–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞:
  // –µ—Å–ª–∏ from === 'ru' ‚Üí –ø–µ—Ä–µ–≤–æ–¥–∏–º –ò–ó —Ä—É—Å—Å–∫–æ–≥–æ –í –∞–Ω–≥–ª–∏–π—Å–∫–∏–π:
  //   –ª–µ–≤–∞—è –∫–Ω–æ–ø–∫–∞: –†—É—Å—Å–∫–∏–π (–∞–∫—Ç–∏–≤–Ω–∞), –ø—Ä–∞–≤–∞—è: –ê–Ω–≥–ª–∏–π—Å–∫–∏–π
  // –µ—Å–ª–∏ from === 'en' ‚Üí –ø–µ—Ä–µ–≤–æ–¥–∏–º –ò–ó –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –í —Ä—É—Å—Å–∫–∏–π:
  //   –ª–µ–≤–∞—è –∫–Ω–æ–ø–∫–∞: –ê–Ω–≥–ª–∏–π—Å–∫–∏–π, –ø—Ä–∞–≤–∞—è: –†—É—Å—Å–∫–∏–π (–∞–∫—Ç–∏–≤–Ω–∞)
  if (from === 'ru') {
    ruBtn.textContent = 'üá∑üá∫ –†—É—Å—Å–∫–∏–π';
    enBtn.textContent = 'üá¨üáß –ê–Ω–≥–ª–∏–π—Å–∫–∏–π';
    ruBtn.classList.add('active');
    enBtn.classList.remove('active');
  } else {
    ruBtn.textContent = 'üá¨üáß –ê–Ω–≥–ª–∏–π—Å–∫–∏–π';
    enBtn.textContent = 'üá∑üá∫ –†—É—Å—Å–∫–∏–π';
    enBtn.classList.add('active');
    ruBtn.classList.remove('active');
  }
}

  async function translate(){
    const input = $id('trInputText');
    if (!input) return;
    const text = (input.value || '').trim();
    if (!text) return void showErr('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞');

    const load = $id('trLoading'),
          err  = $id('trError'),
          res  = $id('trResults');

    err && err.classList.remove('active');
    res && res.classList.remove('active');
    load && load.classList.add('active');

    try {
      const list = await fetchAll(text);
      render(text, list);
    } catch (e) {
      console.error(e);
      showErr('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.');
    } finally {
      load && load.classList.remove('active');
    }
  }

  async function fetchAll(text){
    const out = [], seen = new Set;
    try {
      const u = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=${src}&tl=${tgt}&dt=t&dt=bd&q=${encodeURIComponent(text)}`;
      const r = await fetch(u);
      const d = await r.json();
      if (Array.isArray(d[0])) {
        let m = '';
        d[0].forEach(i => { i[0] && (m += i[0]); });
        if (m && !seen.has(m.toLowerCase())) {
          out.push({ text:m, type:'–æ—Å–Ω–æ–≤–Ω–æ–π', source:'Google', confidence:100 });
          seen.add(m.toLowerCase());
        }
      }
      if (Array.isArray(d[1])) {
        d[1].forEach(g => {
          const pos = g[0];
          Array.isArray(g[1]) && g[1].forEach((w,i) => {
            if (w && !seen.has(w.toLowerCase())) {
              out.push({
                text: w,
                type: pos || '–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π',
                source: 'Google Dict',
                confidence: Math.max(50, 90 - i*5)
              });
              seen.add(w.toLowerCase());
            }
          });
        });
      }
    } catch(e){}

    try {
      const u = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${src}|${tgt}`;
      const r = await fetch(u);
      const d = await r.json();
      const t = d?.responseData?.translatedText;
      if (t && !seen.has(t.toLowerCase())) {
        out.push({ text:t, type:'–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π', source:'MyMemory', confidence:85 });
        seen.add(t.toLowerCase());
      }
    } catch(e){}

    return out.sort((a,b) => b.confidence - a.confidence);
  }

  function esc(s=''){
    return String(s)
      .replace(/&/g,'&amp;')
      .replace(/</g,'&lt;')
      .replace(/>/g,'&gt;');
  }

  function showErr(m){
    const el = $id('trError');
    if (!el) return;
    el.textContent = m;
    el.classList.add('active');
    setTimeout(() => el.classList.remove('active'), 2200);
  }

  function render(original, list){
    const res = $id('trResults');
    if (!res) return;

    const main = list[0];
    const groups = {};
    list.forEach((t,i) => {
      (groups[t.type] || (groups[t.type] = [])).push({ ...t, index:i+1 });
    });

    const enMain = src === 'en' ? original : (tgt === 'en' ? main?.text : '');
    const ruMain = src === 'ru' ? original : (tgt === 'ru' ? main?.text : '');

    let html = '';

    if (main) {
      html += `
        <div class="tr-main">
          <div class="tr-src">
            ${esc(original)}
            <button class="tr-copy-btn" data-copy="${encodeURIComponent(original)}" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç">
              <i class="fas fa-copy"></i>
            </button>
          </div>
          <div class="tr-res">
            <span class="tr-res-text">${esc(main.text)}</span>
            <button class="tr-copy-btn" data-copy="${encodeURIComponent(main.text)}" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥">
              <i class="fas fa-copy"></i>
            </button>
          </div>
          ${enMain ? `
            <div class="tr-add">
              <button class="tr-chip-btn"
                      data-en="${encodeURIComponent(enMain)}"
                      data-ru="${encodeURIComponent(ruMain || '')}"
                      data-src="${src}"
                      data-tgt="${tgt}">
                ‚ûï –í –∏–∑—É—á–µ–Ω–∏–µ
              </button>
            </div>` : ''
          }
        </div>
      `;
    }

    Object.entries(groups).forEach(([type, items]) => {
      html += `
        <div class="tr-group">
          <div class="tr-head">
            <span>${esc(type[0].toUpperCase() + type.slice(1))}</span>
            <span style="color:var(--text-secondary);font-size:13px;">${items.length} –≤–∞—Ä–∏–∞–Ω.</span>
          </div>
          <div class="tr-list">
            ${items.map(it => {
              const en = tgt === 'en' ? it.text : (src === 'en' ? original : '');
              const ru = tgt === 'ru' ? it.text : (src === 'ru' ? original : '');
              return `
                <div class="tr-item">
                  <div class="tr-num">${it.index}</div>
                  <div style="flex:1;min-width:0;">
                    <div class="tr-text">
                      ${esc(it.text)}
                      <button class="tr-copy-btn"
                              data-copy="${encodeURIComponent(it.text)}"
                              title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                    <div class="tr-meta">${esc(it.source)} ‚Ä¢ ${it.confidence}%</div>
                  </div>
                  ${en ? `
                    <button class="tr-chip-btn"
                            data-en="${encodeURIComponent(en)}"
                            data-ru="${encodeURIComponent(ru || '')}"
                            data-src="${src}"
                            data-tgt="${tgt}">
                      ‚ûï
                    </button>` : ''
                  }
                </div>
              `;
            }).join('')}
          </div>
        </div>
      `;
    });

    if (!html) {
      html = '<div class="empty-state"><p>–ü–µ—Ä–µ–≤–æ–¥—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p></div>';
    } else {
      html = `
        <div style="font-size:12px;color:var(--text-secondary);margin-bottom:6px;">
          –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–Ω–∞—á–æ–∫ <i class="fas fa-copy"></i>, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç.
        </div>
      ` + html;
    }

    res.innerHTML = html;
    res.classList.add('active');
  }

  function onClick(e){
    const t = e.target.closest('#trRuBtn, #trEnBtn, #trSwapBtn, #trTranslateBtn, .tr-chip-btn, .tr-copy-btn');
    if (!t) return;

    if (t.id === 'trRuBtn') {
      e.preventDefault();
      setLang('ru','en');
    } else if (t.id === 'trEnBtn') {
      e.preventDefault();
      setLang('en','ru');
    } else if (t.id === 'trSwapBtn') {
      e.preventDefault();
      setLang(src === 'ru' ? 'en' : 'ru', tgt === 'en' ? 'ru' : 'en');
    } else if (t.id === 'trTranslateBtn') {
      e.preventDefault();
      translate();
    } else if (t.classList.contains('tr-chip-btn') && t.dataset.en) {
      e.preventDefault();
      const en = decodeURIComponent(t.dataset.en || '');
      const ru = decodeURIComponent(t.dataset.ru || '');
      if (en && typeof window.onAddToStudy === 'function') {
        window.onAddToStudy({
          term: en,
          meta: {
            ru,
            sourceLang: t.dataset.src,
            targetLang: t.dataset.tgt,
            originalText: ($id('trInputText')?.value || '').trim()
          }
        });
        t.classList.add('added');
        t.textContent = '‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ';
      }
    } else if (t.classList.contains('tr-copy-btn') && t.dataset.copy) {
      e.preventDefault();
      const txt = decodeURIComponent(t.dataset.copy || '');
      if (!txt) return;
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(txt).then(() => {
          t.classList.add('copied');
          t.innerHTML = '‚úì';
          setTimeout(() => {
            t.classList.remove('copied');
            t.innerHTML = '<i class="fas fa-copy"></i>';
          }, 1500);
        }).catch(() => {});
      }
    }
  }

  function onKey(e){
    if (e.key === 'Enter' && e.target?.id === 'trInputText') {
      translate();
    }
  }

  function bindOnce(){
    if (bound) return;
    bound = !0;
    document.addEventListener('click', onClick, !0);
    document.addEventListener('keypress', onKey, !0);
    setLang('ru','en');
  }

  window.initBewordsTranslator = bindOnce;
  document.addEventListener('DOMContentLoaded', bindOnce);
})();
</script>

</body>

</html>

